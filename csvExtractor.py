import pandas as pd

# 1. SETUP: Define your file names and column name here
df = 'nss2025.csv'      # <--- Change this to your source file name
output_csv = 'onlyUni.csv'      # <--- Change this to what you want the new file called
provider_column = 'Provider Name'    # <--- Change this to the header name in your CSV







codes = ['10007825', '90000451', '99999997', '10007778', '10005553', '10007837', '10007838', '10005700', '10007780', '10004063', '10007835', '10007779', '10008017', '10007849', '10000291', '10005451', '10000385', '10005127', '10007759', '10037544', '10031982', '10007857', '10007140', '10007832', '10007811', '10000824', '99999999', '10000961', '10000975', '10001143', '10007854', '10007814', '10001478', '10001726', '10001883', '10007823', '10007772', '10008640', '10007762', '10007833', '10040812', '10080811', '10000163', '10007764', '99999998', '10003270', '10003645', '10003678', '10003854', '10003861', '10003863', '10003956', '10003957', '10004048', '10004078', '10004113', '10004180', '10004351', '10048199', '10004775', '10004797', '10004930', '10007856', '10005337', '10007775', '10005343', '10005389', '10086591', '10005470', '10005500', '10007776', '10005790', '10006022', '10008026', '10007843', '10008010', '10007855', '10007161', '10005545', '10006840', '10007785', '10007787', '10007137', '10007842', '10007789', '10007791', '10007148', '10007149', '10007150', '10007768', '10039956', '10007795', '10007796', '10006842', '10007798', '10007802', '10007157', '10007160', '10007163', '10006566', '10007165', '10000712', '10007784', '10006427', '10007783', '10007152', '10000886', '10007786', '10007788', '10007848', '10007851', '10007852', '10007143', '10007144', '10007790', '10007792', '10007794', '10007145', '10006841', '10007146', '10007147', '10007767', '10007141', '10007151', '10007812', '10007799', '10007138', '10001282', '10007154', '10007774', '10007801', '10007155', '10007156', '10007793', '10007158', '10007803', '10037449', '10006299', '10007804', '10007805', '10014001', '10007159', '10007806', '10007807', '10007858', '10003614', '10007166', '10007139', '10007167', '10007162', '10007114', '10007164', '10007800', '10007527', '10007713', '10005561', '10001503']





df_clean = df[~df['ukprn'].astype(str).str.strip().isin(codes)]

# 5. SAVE THE RESULT
df_clean.to_csv(output_csv, index=False)

print(f"Filtering complete.")
print(f"Rows remaining: {len(df_clean)}")
print(f"Saved to: {output_csv}")